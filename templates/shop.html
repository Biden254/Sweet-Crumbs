{% extends 'base.html' %}
{% block content %}
<div class="max-w-6xl mx-auto px-4 py-10">
  <h1 class="text-3xl font-semibold text-pink-700 mb-4">Shop</h1>
  <form method="get" class="mb-6 flex flex-wrap items-center gap-3">
    <input type="text" name="q" value="{{ query }}" class="flex-1 min-w-[220px] border rounded px-3 py-2" placeholder="Search cakes, cookies, cupcakes..." />
    <select name="c" class="border rounded px-3 py-2">
      <option value="">All categories</option>
      {% for key,label in categories %}
        <option value="{{ key }}" {% if active_category == key %}selected{% endif %}>{{ label }}</option>
      {% endfor %}
    </select>
    <button class="px-4 py-2 rounded bg-pink-600 text-white">Filter</button>
    {% if active_category or query %}
      <a href="/shop/" class="text-pink-700 underline">Clear</a>
    {% endif %}
  </form>
  {% if active_category %}
    <div class="text-sm text-slate-600 mb-4">Filtering by: <span class="font-medium">{{ active_category }}</span></div>
  {% endif %}
  <div class="grid sm:grid-cols-2 md:grid-cols-3 gap-6">
    {% for p in products %}
    <div class="bg-white rounded-xl shadow hover:shadow-lg transition overflow-hidden">
      <a href="/shop/{{ p.id }}/">
        {% if p.category == 'cupcakes' %}
          <img class="h-48 w-full object-cover" src="https://images.unsplash.com/photo-1614707267537-b85aaf00c4b7?w=600&auto=format&fit=crop&q=60&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Mnx8Y3VwY2FrZXN8ZW58MHx8MHx8fDA%3D" alt="Artisanal Cupcakes"/>
        {% elif p.category == 'cookies' %}
          <img class="h-48 w-full object-cover" src="https://images.unsplash.com/photo-1558961363-fa8fdf82db35?w=600&auto=format&fit=crop&q=60&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Mnx8Y29va2llc3xlbnwwfHwwfHx8MA%3D%3D" alt="Fresh Baked Cookies"/>
        {% elif p.category == 'wedding' %}
          <img class="h-48 w-full object-cover" src="https://images.unsplash.com/photo-1604702433171-33756f3f3825?w=600&auto=format&fit=crop&q=60&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8OHx8d2VkZGluZyUyMGNha2V8ZW58MHx8MHx8fDA%3D" alt="Elegant Wedding Cakes"/>
        {% elif p.category == 'birthday' %}
          <img class="h-48 w-full object-cover" src="https://images.unsplash.com/photo-1606983340126-99ab4feaa64a?w=600&auto=format&fit=crop&q=60&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Mnx8YmlydGhkYXklMjBjYWtlfGVufDB8fDB8fHww" alt="Celebration Birthday Cakes"/>
        {% elif p.category == 'delivery' %}
          <img class="h-48 w-full object-cover" src="https://plus.unsplash.com/premium_photo-1664391971960-bbaf10a2e1bd?q=80&w=755&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D" alt="Fresh Cake Delivery"/>
        {% elif p.category == 'decorating' %}
          <img class="h-48 w-full object-cover" src="https://images.unsplash.com/photo-1611810797891-ac09c37a1f93?w=600&auto=format&fit=crop&q=60&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Mnx8Y2FrZSUyMGRlY29yYXRpb258ZW58MHx8MHx8fDA%3D" alt="Custom Cake Decorating"/>
        {% else %}
          <img class="h-48 w-full object-cover" src="https://images.unsplash.com/photo-1551024506-0bcc5e0577f6?w=800&q=80&auto=format&fit=crop" alt="Sweet Crumbs Bakery"/>
        {% endif %}
      </a>
      <div class="p-4">
        <div class="font-medium">{{ p.name }}</div>
        <div class="text-slate-500">${{ p.price }}</div>
        <div class="mt-3 flex gap-2">
          <a class="px-3 py-2 rounded bg-pink-600 text-white" href="/orders/cart/add/{{ p.id }}/">Add to Cart</a>
          <a class="px-3 py-2 rounded border border-pink-600 text-pink-700" href="/shop/{{ p.id }}/">Details</a>
        </div>
      </div>
    </div>
    {% empty %}
      <div>No products match your filters.</div>
    {% endfor %}
  </div>
</div>
{% endblock %}


